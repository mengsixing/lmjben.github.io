(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{193:function(e,s,t){"use strict";t.r(s);var a=t(0),n=Object(a.a)({},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"kubernetes-ä½¿ç”¨æ€»ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-ä½¿ç”¨æ€»ç»“","aria-hidden":"true"}},[e._v("#")]),e._v(" Kubernetes ä½¿ç”¨æ€»ç»“")]),e._v(" "),t("p",[e._v("Kubernetes ç®€ç§° k8sï¼Œæ˜¯ google åœ¨ 2014 å¹´å‘å¸ƒçš„ä¸€ä¸ªå¼€æºé¡¹ç›®ã€‚")]),e._v(" "),t("p",[e._v("Kubernetes è§£å†³äº†å“ªäº›é—®é¢˜ï¼Ÿ")]),e._v(" "),t("p",[e._v("çœŸå®çš„ç”Ÿäº§ç¯å¢ƒåº”ç”¨ä¼šåŒ…å«å¤šä¸ªå®¹å™¨ï¼Œè€Œè¿™äº›å®¹å™¨è¿˜å¾ˆå¯èƒ½ä¼šè·¨è¶Šå¤šä¸ªæœåŠ¡å™¨ä¸»æœºéƒ¨ç½²ã€‚Kubernetes æä¾›äº†ä¸ºé‚£äº›å·¥ä½œè´Ÿè½½å¤§è§„æ¨¡éƒ¨ç½²å®¹å™¨çš„ç¼–æ’ä¸ç®¡ç†èƒ½åŠ›ã€‚Kubernetes ç¼–æ’è®©ä½ èƒ½å¤Ÿæ„å»ºå¤šå®¹å™¨çš„åº”ç”¨æœåŠ¡ï¼Œåœ¨é›†ç¾¤ä¸Šè°ƒåº¦æˆ–ä¼¸ç¼©è¿™äº›å®¹å™¨ï¼Œä»¥åŠç®¡ç†å®ƒä»¬éšæ—¶é—´å˜åŒ–çš„å¥åº·çŠ¶æ€ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("kubernetes åŸºç¡€")]),e._v(" "),t("li",[e._v("kubernetes ä¼˜åŒ–")]),e._v(" "),t("li",[e._v("kubernetes å®æˆ˜")])]),e._v(" "),t("h2",{attrs:{id:"kubernetes-åŸºç¡€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-åŸºç¡€","aria-hidden":"true"}},[e._v("#")]),e._v(" kubernetes åŸºç¡€")]),e._v(" "),t("p",[e._v("k8s ä¸­æœ‰å‡ ä¸ªé‡è¦æ¦‚å¿µã€‚")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",[e._v("æ¦‚å¿µ")]),e._v(" "),t("th",[e._v("ä»‹ç»")])])]),e._v(" "),t("tbody",[t("tr",[t("td",[e._v("cluster")]),e._v(" "),t("td",[e._v("ä¸€ä¸ª k8s é›†ç¾¤")])]),e._v(" "),t("tr",[t("td",[e._v("master")]),e._v(" "),t("td",[e._v("é›†ç¾¤ä¸­çš„ä¸€å°æœºå™¨ï¼Œæ˜¯é›†ç¾¤çš„æ ¸å¿ƒï¼Œè´Ÿè´£æ•´ä¸ªé›†ç¾¤çš„ç®¡ç†å’Œæ§åˆ¶")])]),e._v(" "),t("tr",[t("td",[e._v("node")]),e._v(" "),t("td",[e._v("é›†ç¾¤ä¸­çš„ä¸€å°æœºå™¨ï¼Œæ˜¯é›†ç¾¤ä¸­çš„å·¥ä½œè´Ÿè½½èŠ‚ç‚¹")])]),e._v(" "),t("tr",[t("td",[e._v("pod")]),e._v(" "),t("td",[e._v("k8s æœ€å°è°ƒåº¦å•ä½ï¼Œæ¯ä¸ª pod åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨")])]),e._v(" "),t("tr",[t("td",[e._v("controller")]),e._v(" "),t("td",[e._v("kubernetes é€šè¿‡ controller æ¥ç®¡ç† pod")])]),e._v(" "),t("tr",[t("td",[e._v("service")]),e._v(" "),t("td",[e._v("å°†æœåŠ¡å†…å®¹ä¸å…·ä½“çš„ pod åˆ†ç¦»ï¼Œè´Ÿè´£è‡ªåŠ¨å°†è¯·æ±‚åˆ†å‘åˆ°æ­£ç¡®çš„ pod å¤„")])]),e._v(" "),t("tr",[t("td",[e._v("namespace")]),e._v(" "),t("td",[e._v("å°† cluster é€»è¾‘ä¸Šåˆ’åˆ†æˆå¤šä¸ªè™šæ‹Ÿ clusterï¼Œæ¯ä¸ª cluster å°±æ˜¯ä¸€ä¸ª namespace")])])])]),e._v(" "),t("h3",{attrs:{id:"cluster"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cluster","aria-hidden":"true"}},[e._v("#")]),e._v(" Cluster")]),e._v(" "),t("p",[e._v("Cluster æ˜¯è®¡ç®—ã€å­˜å‚¨å’Œç½‘ç»œèµ„æºçš„é›†åˆï¼Œkubernetes åˆ©ç”¨è¿™äº›èµ„æºè¿è¡Œå„ç§åŸºäºå®¹å™¨çš„åº”ç”¨ã€‚")]),e._v(" "),t("h3",{attrs:{id:"master-èŠ‚ç‚¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#master-èŠ‚ç‚¹","aria-hidden":"true"}},[e._v("#")]),e._v(" Master èŠ‚ç‚¹")]),e._v(" "),t("p",[e._v("Master æ˜¯ cluster çš„å¤§è„‘ï¼Œè¿è¡Œç€çš„ Daemonï¼ˆä¸€ç›´è¿è¡Œçš„æœåŠ¡ç«¯ç¨‹åºï¼Œåˆç§°ä¸ºå®ˆæŠ¤è¿›ç¨‹ï¼‰æœåŠ¡åŒ…æ‹¬ kube-apiserverã€kube-schedulerã€kube-controller-managerã€etcd å’Œ pod ç½‘ç»œã€‚")]),e._v(" "),t("ul",[t("li",[e._v("kube-apiserver\n"),t("ul",[t("li",[e._v("æä¾› restful apiï¼Œå³ kubernetes apiã€‚apiserver æ˜¯ kubernetes cluster çš„å‰ç«¯æ¥å£ï¼Œå„ç§å®¢æˆ·ç«¯å·¥å…·ä»¥åŠ kubernetes å…¶ä»–ç»„ä»¶ã€‚å¯ä»¥é€šè¿‡å®ƒç®¡ç† cluster çš„å„ç§èµ„æºã€‚")])])]),e._v(" "),t("li",[e._v("kube-scheduler\n"),t("ul",[t("li",[e._v("è´Ÿè´£å†³å®šå°† pod æ”¾åœ¨å“ªä¸ª node ä¸Šè¿è¡Œï¼Œscheduler åœ¨è°ƒåº¦æ—¶ä¼šå……åˆ†è€ƒè™‘ cluster ä¸­å„ä¸ªèŠ‚ç‚¹çš„è´Ÿè½½ï¼Œä»¥åŠåº”ç”¨å¯¹é«˜å¯ç”¨ã€æ€§èƒ½ã€æ•°æ®äº²å’Œæ€§çš„éœ€æ±‚ã€‚")])])]),e._v(" "),t("li",[e._v("kube-controller-manager\n"),t("ul",[t("li",[e._v("è´Ÿè´£ç®¡ç† cluster å„ç§èµ„æºï¼Œä¿è¯èµ„æºå¤„ç†é¢„æœŸçŠ¶æ€ã€‚controller-manager ç”±å¤šç§ controller ç»„æˆï¼ŒåŒ…æ‹¬ replication controllerï¼Œendpoint controllerï¼Œnamespace controllerï¼Œserviceaccount controller ç­‰ã€‚")]),e._v(" "),t("li",[e._v("ä¸åŒçš„ controller ç®¡ç†ä¸åŒçš„èµ„æºï¼Œä¾‹å¦‚ï¼šreplication controller ç®¡ç† deployment ï¼Œstatefulsetï¼Œdamonset çš„ç”Ÿå‘½å‘¨æœŸï¼Œnamespace controller èµ„æºç®¡ç† namespace èµ„æºã€‚")])])]),e._v(" "),t("li",[e._v("etcdï¼ˆåˆ†å¸ƒå¼ key-value å­˜å‚¨åº“ï¼‰\n"),t("ul",[t("li",[e._v("è´Ÿè´£ä¿å­˜ cluster çš„é…ç½®ä¿¡æ¯å’Œå„ç§èµ„æºçš„çŠ¶æ€ä¿¡æ¯ã€‚å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œetcd ä¼šå¿«é€Ÿåœ°é€šçŸ¥ kubernetes ç›¸å…³ç»„ä»¶ã€‚")])])]),e._v(" "),t("li",[e._v("pod ç½‘ç»œ\n"),t("ul",[t("li",[e._v("pod è¦èƒ½å¤Ÿé€šä¿¡ï¼Œcluster å¿…é¡»éƒ¨ç½² pod ç½‘ç»œï¼Œflannel æ˜¯å…¶ä¸­ä¸€ä¸ªå¯é€‰æ–¹æ¡ˆã€‚")])])])]),e._v(" "),t("h3",{attrs:{id:"node-èŠ‚ç‚¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#node-èŠ‚ç‚¹","aria-hidden":"true"}},[e._v("#")]),e._v(" Node èŠ‚ç‚¹")]),e._v(" "),t("p",[e._v("Node èŠ‚ç‚¹ æ˜¯ pod è¿è¡Œçš„åœ°æ–¹ã€‚node èŠ‚ç‚¹ä¸Šè¿è¡Œçš„ k8s ç»„ä»¶æœ‰ kubeletã€kube-proxy å’Œ pod ç½‘ç»œã€‚")]),e._v(" "),t("ul",[t("li",[e._v("kubelet\n"),t("ul",[t("li",[e._v("kubelet æ˜¯ node èŠ‚ç‚¹çš„ä»£ç†ï¼Œå½“ master èŠ‚ç‚¹ä¸­ kube-scheduler ç¡®å®šåœ¨æŸä¸ª node èŠ‚ç‚¹ä¸Šè¿è¡Œ pod åï¼Œä¼šå°† pod çš„å…·ä½“é…ç½®ä¿¡æ¯å‘é€ç»™è¯¥èŠ‚ç‚¹çš„ kubeletï¼Œkubelet æ ¹æ®è¿™äº›ä¿¡æ¯åˆ›å»ºå’Œè¿è¡Œå®¹å™¨ï¼Œå¹¶å‘ master èŠ‚ç‚¹æŠ¥å‘Šè¿è¡ŒçŠ¶æ€ã€‚")])])]),e._v(" "),t("li",[e._v("kube-proxy\n"),t("ul",[t("li",[e._v("æ¯ä¸ª node èŠ‚ç‚¹éƒ½ä¼šè¿è¡Œ kube-proxy æœåŠ¡ï¼Œå®ƒè´Ÿè´£å°†è®¿é—® service çš„è¯·æ±‚è½¬å‘åˆ°åç«¯çš„å®¹å™¨ã€‚å¦‚æœæœ‰å¤šä¸ªå‰¯æœ¬ï¼Œkube-proxy ä¼šå®ç°è´Ÿè½½å‡è¡¡ã€‚")])])]),e._v(" "),t("li",[e._v("pod ç½‘ç»œ\n"),t("ul",[t("li",[e._v("pod è¦èƒ½å¤Ÿç›¸äº’é€šä¿¡ï¼Œk8s cluster å¿…é¡»éƒ¨ç½² pod ç½‘ç»œï¼Œflannel æ˜¯å…¶ä¸­ä¸€ä¸ªå¯é€‰æ–¹æ¡ˆã€‚")])])])]),e._v(" "),t("h3",{attrs:{id:"pod"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pod","aria-hidden":"true"}},[e._v("#")]),e._v(" Pod")]),e._v(" "),t("p",[e._v("æ¯ä¸€ä¸ª pod åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª containerï¼Œpod ä¸­çš„å®¹å™¨ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢« master è°ƒåº¦åˆ° node èŠ‚ç‚¹ä¸Šè¿è¡Œã€‚")]),e._v(" "),t("ul",[t("li",[e._v("ä¸ºä»€ä¹ˆ k8s ä½¿ç”¨ pod ç®¡ç†å®¹å™¨ï¼Œè€Œä¸æ˜¯ç›´æ¥æ“ä½œå®¹å™¨ï¼Ÿ")])]),e._v(" "),t("p",[e._v("ç­”ï¼šå› ä¸ºæœ‰äº›å®¹å™¨å¤©ç”Ÿå°±æ˜¯éœ€è¦ç´§å¯†çš„è”ç³»ï¼Œæ”¾åœ¨ä¸€ä¸ª pod ä¸­æ–¹ä¾¿ç®¡ç†ã€‚åŒæ—¶ pod ä¸­çš„æ‰€æœ‰å®¹å™¨ä½¿ç”¨åŒä¸€ä¸ªç½‘ç»œï¼Œå³ç›¸åŒçš„ ip åœ°å€å’Œ port ç©ºé—´ï¼Œæ–¹ä¾¿è¿›è¡Œæ•°æ®å…±äº«ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("ä»€ä¹ˆæ—¶å€™éœ€è¦åœ¨ pod ä¸­å®šä¹‰å¤šä¸ªå®¹å™¨ï¼Ÿ")])]),e._v(" "),t("p",[e._v("ç­”ï¼šè¿™äº›å®¹å™¨è”ç³»éå¸¸ç´§å¯†ï¼Œè€Œä¸”éœ€è¦ç›´æ¥å…±äº«èµ„æºï¼Œä¾‹å¦‚ä¸€ä¸ªçˆ¬è™«ç¨‹åºï¼Œå’Œä¸€ä¸ª web server ç¨‹åºã€‚web server å¼ºçƒˆä¾èµ–çˆ¬è™«ç¨‹åºæä¾›æ•°æ®æ”¯æŒã€‚")]),e._v(" "),t("h3",{attrs:{id:"controller"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#controller","aria-hidden":"true"}},[e._v("#")]),e._v(" Controller")]),e._v(" "),t("p",[e._v("k8s é€šå¸¸ä¸ä¼šç›´æ¥åˆ›å»º podï¼Œè€Œæ˜¯é€šè¿‡ controller æ¥ç®¡ç† podã€‚controller ä¸­å®šä¹‰äº† pod çš„éƒ¨ç½²ç‰¹æ€§ï¼Œæ¯”å¦‚æœ‰å‡ ä¸ªå‰¯æœ¬ï¼Œåœ¨ä»€ä¹ˆæ ·çš„ node ä¸Šè¿è¡Œç­‰ã€‚ä¸ºäº†æ»¡è¶³ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼Œk8s æä¾›äº†å¤šç§ç±»å‹çš„ controllerã€‚")]),e._v(" "),t("ul",[t("li",[e._v("Deployment\n"),t("ul",[t("li",[e._v("æœ€å¸¸ä½¿ç”¨ï¼Œå¯ä»¥ç®¡ç† pod å¤šä¸ªå‰¯æœ¬ï¼Œå¹¶ç¡®ä¿ pod æŒ‰ç…§æœŸæœ›çš„çŠ¶æ€è¿è¡Œï¼Œåº•å±‚è°ƒç”¨ ReplicaSetã€‚")])])]),e._v(" "),t("li",[e._v("ReplicaSet\n"),t("ul",[t("li",[e._v("å®ç° pod çš„å¤šå‰¯æœ¬ç®¡ç†ï¼Œé€šå¸¸ä½¿ç”¨ Deployment å°±å¤Ÿäº†ã€‚")])])]),e._v(" "),t("li",[e._v("DaemonSet\n"),t("ul",[t("li",[e._v("ç”¨äºæ¯ä¸ª node æœ€å¤šåªè¿è¡Œä¸€ä¸ª pod å‰¯æœ¬çš„åœºæ™¯ã€‚")]),e._v(" "),t("li",[e._v("ä½¿ç”¨åœºæ™¯\n"),t("ul",[t("li",[e._v("åœ¨é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œå­˜å‚¨ Daemonï¼Œæ¯”å¦‚ glusterd æˆ– cephã€‚")]),e._v(" "),t("li",[e._v("åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œæ—¥å¿—æœé›† Daemonï¼Œæ¯”å¦‚ flunentd æˆ– logstashã€‚")]),e._v(" "),t("li",[e._v("åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œç›‘æ§ï¼Œæ¯”å¦‚ Prometheus Node Exporter æˆ– collectedã€‚")])])])])]),e._v(" "),t("li",[e._v("StatefuleSet\n"),t("ul",[t("li",[e._v("èƒ½å¤Ÿä¿è¯ pod çš„æ¯ä¸ªå‰¯æœ¬åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­åç§°æ˜¯ä¸å˜çš„ï¼Œè€Œå…¶ä»– controller ä¸æä¾›è¿™ä¸ªåŠŸèƒ½ã€‚")])])]),e._v(" "),t("li",[e._v("Job\n"),t("ul",[t("li",[e._v("ç”¨äºè¿è¡Œç»“æŸå°±åˆ é™¤çš„åº”ç”¨ï¼Œè€Œå…¶ä»– controller ä¸­çš„ pod é€šå¸¸æ˜¯é•¿æœŸæŒç»­è¿è¡Œã€‚")])])])]),e._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[e._v("æç¤º")]),e._v(" "),t("p",[e._v("ä½¿ç”¨ deployment controller åˆ›å»ºçš„ç”¨ä¾‹ï¼Œå¦‚æœå‡ºç°æœ‰ pod æŒ‚æ‰çš„æƒ…å†µï¼Œä¼šè‡ªåŠ¨æ–°å»ºä¸€ä¸ª podï¼Œæ¥æ»¡è¶³å†…éƒ¨å®šä¹‰çš„ replicas å­—æ®µè¦æ±‚ã€‚")])]),e._v(" "),t("h4",{attrs:{id:"job"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#job","aria-hidden":"true"}},[e._v("#")]),e._v(" Job")]),e._v(" "),t("p",[e._v("å®¹å™¨æŒ‰ç…§æŒç»­è¿è¡Œæ—¶é—´å¯åˆ†ä¸ºä¸¤ç±»ï¼šæœåŠ¡ç±»å®¹å™¨å’Œå·¥ä½œç±»å®¹å™¨ã€‚")]),e._v(" "),t("p",[e._v("æœåŠ¡ç±»å®¹å™¨é€šå¸¸æŒç»­æä¾›æœåŠ¡ï¼Œéœ€è¦ä¸€ç›´è¿è¡Œï¼Œæ¯”å¦‚ http serverã€‚å·¥ä½œç±»å®¹å™¨åˆ™æ˜¯ä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œæ¯”å¦‚æ‰¹å¤„ç†ç¨‹åºï¼Œå®Œæˆåå®¹å™¨å°±é€€å‡ºã€‚")]),e._v(" "),t("p",[e._v("Controller ä¸­ deploymentã€replicaSet å’Œ daemonSet ç±»å‹éƒ½ç”¨äºç®¡ç†æœåŠ¡ç±»å®¹å™¨ï¼Œå¯¹äºå·¥ä½œç±»å®¹å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨ jobã€‚")]),e._v(" "),t("h3",{attrs:{id:"service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#service","aria-hidden":"true"}},[e._v("#")]),e._v(" Service")]),e._v(" "),t("p",[e._v("Service æ˜¯å¯ä»¥è®¿é—®ä¸€ç»„ pod çš„ç­–ç•¥ â€”â€” é€šå¸¸ç§°ä¸ºå¾®æœåŠ¡ã€‚ å…·ä½“è®¿é—®å“ªä¸€ç»„ pod é€šå¸¸æ˜¯é€šè¿‡ label è¿›è¡Œé€‰æ‹©çš„ã€‚service ä¸º pod æä¾›äº†è´Ÿè½½å‡è¡¡ï¼ŒåŸç†æ˜¯ä½¿ç”¨ iptablesã€‚")]),e._v(" "),t("p",[e._v("ä¸ºä»€ä¹ˆè¦ç”¨ service ï¼Ÿ")]),e._v(" "),t("ul",[t("li",[e._v("pod æ˜¯æœ‰ç”Ÿå‘½å‘¨æœŸçš„ï¼Œå®ƒä»¬å¯ä»¥è¢«åˆ›å»ºï¼Œä¹Ÿå¯ä»¥è¢«é”€æ¯ï¼Œç„¶è€Œä¸€æ—¦è¢«é”€æ¯ç”Ÿå‘½å°±æ°¸è¿œç»“æŸã€‚è€Œ pod åœ¨ä¸€ä¸ª k8s é›†ç¾¤ä¸­å¯èƒ½ç»å¸¸æ€§çš„åˆ›å»ºï¼Œé”€æ¯ï¼Œæ¯ä¸€æ¬¡é‡å»ºéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ ip åœ°å€ã€‚")]),e._v(" "),t("li",[e._v("service ä»é€»è¾‘ä¸Šä»£è¡¨äº†ä¸€ç»„ podï¼Œå…·ä½“æ˜¯å“ªäº› pod æ˜¯ç”± label æ¥æŒ‘é€‰çš„ã€‚service æœ‰è‡ªå·±çš„ ipï¼Œè€Œä¸”è¿™ä¸ª ip æ˜¯ä¸å˜çš„ï¼Œå®¢æˆ·ç«¯åªéœ€è¦è®¿é—® service çš„ ipï¼Œk8s åˆ™è´Ÿè´£å»ºç«‹å’Œç»´æŠ¤ service ä¸ pod çš„æ˜ å°„å…³ç³»ï¼Œæ— è®º pod å¦‚ä½•å˜åŒ–ï¼Œå¯¹å®¢æˆ·ç«¯ä¸ä¼šæœ‰ä»»ä½•å½±å“ï¼Œå› ä¸º service æ²¡æœ‰å˜ã€‚")])]),e._v(" "),t("p",[e._v("å¤–ç½‘å¦‚ä½•è®¿é—® serviceï¼Ÿ")]),e._v(" "),t("ul",[t("li",[e._v("ClusterIPï¼šé€šè¿‡é›†ç¾¤çš„å†…éƒ¨ ip æš´éœ²æœåŠ¡ï¼Œé€‰æ‹©è¯¥å€¼ï¼ŒæœåŠ¡åªèƒ½å¤Ÿåœ¨é›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®ï¼Œè¿™ä¹Ÿæ˜¯é»˜è®¤çš„ ServiceTypeã€‚")]),e._v(" "),t("li",[e._v("NodePortï¼šé€šè¿‡æ¯ä¸ª node ä¸Šçš„ ip å’Œç«¯å£ï¼ˆNodePortï¼‰æš´éœ²æœåŠ¡ã€‚NodePort æœåŠ¡ä¼šè·¯ç”±åˆ° ClusterIP æœåŠ¡ï¼Œè¿™ä¸ª ClusterIP æœåŠ¡ä¼šè‡ªåŠ¨åˆ›å»ºã€‚é€šè¿‡è¯·æ±‚ "),t("code",[e._v("nodeip:nodeport")]),e._v("ï¼Œå¯ä»¥ä»é›†ç¾¤çš„å¤–éƒ¨è®¿é—®ä¸€ä¸ª service æœåŠ¡ã€‚")]),e._v(" "),t("li",[e._v("LoadBalancerï¼šä½¿ç”¨äº‘æä¾›å•†çš„è´Ÿè½½å±€è¡¡å™¨ï¼Œå¯ä»¥å‘å¤–éƒ¨æš´éœ²æœåŠ¡ã€‚å¤–éƒ¨çš„è´Ÿè½½å‡è¡¡å™¨å¯ä»¥è·¯ç”±åˆ° NodePort æœåŠ¡å’Œ ClusterIP æœåŠ¡ã€‚")]),e._v(" "),t("li",[e._v("ExternalNameï¼šé€šè¿‡è¿”å› CNAME å’Œå®ƒçš„å€¼ï¼Œå¯ä»¥å°†æœåŠ¡æ˜ å°„åˆ° externalName å­—æ®µçš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œ foo.bar.example.comï¼‰ã€‚ æ²¡æœ‰ä»»ä½•ç±»å‹ä»£ç†è¢«åˆ›å»ºï¼Œè¿™åªæœ‰ Kubernetes 1.7 æˆ–æ›´é«˜ç‰ˆæœ¬çš„ kube-dns æ‰æ”¯æŒã€‚")])]),e._v(" "),t("h3",{attrs:{id:"namespace"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#namespace","aria-hidden":"true"}},[e._v("#")]),e._v(" Namespace")]),e._v(" "),t("p",[e._v("å¦‚æœæœ‰å¤šä¸ªç”¨æˆ·ä½¿ç”¨åŒä¸€ä¸ª k8s clusterï¼Œå¦‚ä½•å°†ä»–ä»¬åˆ›å»ºçš„ controllerï¼Œpod ç­‰èµ„æºåˆ†å¼€å‘¢ï¼Ÿ")]),e._v(" "),t("p",[e._v("ç­”ï¼šä½¿ç”¨ namespaceã€‚")]),e._v(" "),t("p",[e._v("å¦‚æœå°†ç‰©ç†çš„ cluster é€»è¾‘ä¸Šåˆ’åˆ†æˆå¤šä¸ªè™šæ‹Ÿ clusterï¼Œæ¯ä¸ª cluster å°±æ˜¯ä¸€ä¸ª namespaceï¼Œä¸åŒ namespace é‡Œçš„èµ„æºæ˜¯å®Œå…¨éš”ç¦»çš„ã€‚")]),e._v(" "),t("p",[e._v("k8s é»˜è®¤åˆ›å»ºäº†ä¸¤ä¸ª namespaceã€‚")]),e._v(" "),t("ul",[t("li",[e._v("default åˆ›å»ºèµ„æºæ—¶å¦‚æœä¸æŒ‡å®šï¼Œå°†ä¼šæ”¾åˆ°è¿™ä¸ª namespace ä¸­ã€‚")]),e._v(" "),t("li",[e._v("kube-system å­˜æ”¾ k8s è‡ªå·±åˆ›å»ºçš„ç³»ç»Ÿèµ„æºã€‚")])]),e._v(" "),t("h2",{attrs:{id:"kubernetes-ä¼˜åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-ä¼˜åŒ–","aria-hidden":"true"}},[e._v("#")]),e._v(" Kubernetes ä¼˜åŒ–")]),e._v(" "),t("ul",[t("li",[e._v("å¥åº·æ£€æŸ¥")]),e._v(" "),t("li",[e._v("æ•°æ®ç®¡ç†")]),e._v(" "),t("li",[e._v("å¯†ç ç®¡ç†")]),e._v(" "),t("li",[e._v("é›†ç¾¤ç›‘æ§")])]),e._v(" "),t("h3",{attrs:{id:"å¥åº·æ£€æŸ¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¥åº·æ£€æŸ¥","aria-hidden":"true"}},[e._v("#")]),e._v(" å¥åº·æ£€æŸ¥")]),e._v(" "),t("p",[e._v("å¼ºå¤§çš„è‡ªæ„ˆèƒ½åŠ›æ˜¯ k8s è¿™ç±»å®¹å™¨ç¼–æ’å¼•æ“çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ã€‚è‡ªæ„ˆçš„é»˜è®¤å®ç°æ–¹å¼æ˜¯è‡ªåŠ¨é‡å¯å‘ç”Ÿæ•…éšœçš„å®¹å™¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥åˆ©ç”¨ liveness å’Œ readiness æ¢æµ‹æœºåˆ¶è®¾ç½®æ›´ç²¾ç»†çš„å¥åº·æ£€æŸ¥ï¼Œè¿›è€Œå®ç°å¦‚ä¸‹éœ€æ±‚ï¼š")]),e._v(" "),t("ul",[t("li",[e._v("é›¶åœæœºéƒ¨ç½²")]),e._v(" "),t("li",[e._v("é¿å…éƒ¨ç½²æ— æ•ˆçš„é•œåƒ")]),e._v(" "),t("li",[e._v("æ›´åŠ å®‰å…¨çš„æ»šåŠ¨å‡çº§")])]),e._v(" "),t("p",[e._v("é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰å®¹å™¨è¿›ç¨‹è¿”å›å€¼éé›¶ï¼Œk8s æ‰ä¼šè®¤ä¸ºå®¹å™¨å‘ç”Ÿäº†æ•…éšœï¼Œéœ€è¦é‡å¯ã€‚å¦‚æœæˆ‘ä»¬æƒ³æ›´åŠ ç»†ç²’åº¦çš„æ§åˆ¶å®¹å™¨é‡å¯ï¼Œå¯ä»¥ä½¿ç”¨ liveness å’Œ readinessã€‚")]),e._v(" "),t("p",[e._v("liveness å’Œ readiness çš„åŸç†æ˜¯å®šæœŸæ£€æŸ¥ "),t("code",[e._v("/tmp/healthy")]),e._v(" æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨å³è®¤ä¸ºç¨‹åºæ²¡æœ‰å‡ºæ•…éšœï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šé‡‡å–ç›¸åº”çš„æªæ–½æ¥è¿›è¡Œåé¦ˆã€‚")]),e._v(" "),t("p",[e._v("liveness é‡‡å–çš„ç­–ç•¥æ˜¯é‡å¯å®¹å™¨ï¼Œè€Œ readiness é‡‡å–çš„ç­–ç•¥æ˜¯å°†å®¹å™¨è®¾ç½®ä¸ºä¸å¯ç”¨ã€‚")]),e._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[e._v("æ¡ˆä¾‹")]),e._v(" "),t("p",[e._v("å¦‚æœéœ€è¦åœ¨ç‰¹å®šæƒ…å†µä¸‹é‡å¯å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ livenessã€‚")]),e._v(" "),t("p",[e._v("å¦‚æœéœ€è¦ä¿è¯å®¹å™¨ä¸€ç›´å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ readinessã€‚")])]),e._v(" "),t("p",[e._v("æˆ‘ä»¬å¯ä»¥å°† liveness å’Œ readiness é…åˆä½¿ç”¨ï¼Œä½¿ç”¨ liveness åˆ¤æ–­å®¹å™¨æ˜¯å¦éœ€è¦é‡å¯ï¼Œç”¨ readiness åˆ¤æ–­å®¹å™¨æ˜¯å¦å·²ç»å‡†å¤‡å¥½å¯¹å¤–æä¾›æœåŠ¡ã€‚")]),e._v(" "),t("h3",{attrs:{id:"æ•°æ®ç®¡ç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ•°æ®ç®¡ç†","aria-hidden":"true"}},[e._v("#")]),e._v(" æ•°æ®ç®¡ç†")]),e._v(" "),t("p",[e._v("ä¸Šæ–‡è¯´é“ï¼Œpod å¯èƒ½ä¼šè¢«é¢‘ç¹åœ°é”€æ¯å’Œåˆ›å»ºï¼Œå½“å®¹å™¨é”€æ¯æ—¶ï¼Œä¿å­˜åœ¨å®¹å™¨å†…éƒ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ•°æ®éƒ½ä¼šè¢«æ¸…é™¤ã€‚ä¸ºäº†æŒä¹…åŒ–ä¿å­˜å®¹å™¨çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ k8s volumeã€‚")]),e._v(" "),t("p",[e._v("Volume çš„ç”Ÿå‘½å‘¨æœŸç‹¬ç«‹äºå®¹å™¨ï¼Œpod ä¸­çš„å®¹å™¨å¯èƒ½è¢«é”€æ¯å’Œé‡å»ºï¼Œä½† volume ä¼šè¢«ä¿ç•™ã€‚å®è´¨ä¸Š vloume æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå½“ volume è¢« mount åˆ° podï¼Œpod ä¸­çš„æ‰€æœ‰å®¹å™¨éƒ½å¯ä»¥è®¿é—®åˆ°è¿™ä¸ª volumeã€‚")]),e._v(" "),t("p",[e._v("Volume æ”¯æŒå¤šç§ç±»å‹ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("emptyDir\n"),t("ul",[t("li",[e._v("æ•°æ®å­˜æ”¾åœ¨ pod ä¸­ï¼Œå¯¹ pod ä¸­çš„å®¹å™¨æ¥è¯´ï¼Œæ˜¯æŒä¹…çš„ï¼Œåªè¦ pod è¿˜åœ¨æ•°æ®å°±è¿˜åœ¨ã€‚")])])]),e._v(" "),t("li",[e._v("hostPath\n"),t("ul",[t("li",[e._v("æ•°æ®å­˜åœ¨ä¸»æœºä¸Šï¼Œä¸»æœºåœ¨æ•°æ®å°±åœ¨ã€‚")])])]),e._v(" "),t("li",[e._v("AWS Elastic Block Store\n"),t("ul",[t("li",[e._v("æ•°æ®å­˜åœ¨äº‘æœåŠ¡å™¨ä¸Šã€‚")])])]),e._v(" "),t("li",[e._v("Persistent Volume\n"),t("ul",[t("li",[e._v("è‡ªå®šä¹‰ä¸€å—å¤–éƒ¨å­˜å‚¨ç©ºé—´ Persistent Volumeï¼Œç„¶ååœ¨åˆ›å»º pod æ—¶ä½¿ç”¨ PersistentVolumeClaimï¼ˆPVCï¼‰å»ç”³è¯·ç©ºé—´ï¼Œå¹¶è¿›è¡Œå­˜å‚¨ã€‚")])])])]),e._v(" "),t("p",[e._v("Volume æä¾›äº†å¯¹å„ç§ç±»å‹çš„å­˜æ”¾æ–¹å¼ï¼Œä½†å®¹å™¨åœ¨ä½¿ç”¨ volume è¯»å†™æ•°æ®æ—¶ï¼Œä¸éœ€è¦å…³å¿ƒæ•°æ®åˆ°åº•æ˜¯å­˜æ”¾åœ¨æœ¬åœ°èŠ‚ç‚¹çš„ç³»ç»Ÿä¸­è¿˜æ˜¯äº‘ç¡¬ç›˜ä¸Šã€‚å¯¹å®¹å™¨æ¥è¯´ï¼Œæ‰€æœ‰ç±»å‹çš„ volume éƒ½åªæ˜¯ä¸€ä¸ªç›®å½•ã€‚")]),e._v(" "),t("h3",{attrs:{id:"å¯†ç ç®¡ç†"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¯†ç ç®¡ç†","aria-hidden":"true"}},[e._v("#")]),e._v(" å¯†ç ç®¡ç†")]),e._v(" "),t("p",[e._v("åº”ç”¨ç¨‹åºåœ¨å¯åŠ¨è¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦ä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚è®¿é—®æ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç ã€‚å°†è¿™äº›ä¿¡æ¯ç›´æ¥ä¿å­˜åœ¨å®¹å™¨é•œåƒä¸­æ˜¾ç„¶ä¸å¦¥ï¼Œk8s æä¾›çš„è§£å†³æ–¹æ¡ˆæ˜¯ secretã€‚")]),e._v(" "),t("p",[e._v("secret ä¼šä»¥å¯†æ–‡çš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œé¿å…ç›´æ¥åœ¨é…ç½®æ–‡ä»¶ä¸­ä¿å­˜æ•æ„Ÿä¿¡æ¯ã€‚secret ä¼šä»¥ volume çš„å½¢å¼è¢« mount åˆ° podï¼Œå®¹å™¨å¯é€šè¿‡æ–‡ä»¶çš„æ–¹å¼ä½¿ç”¨ secret ä¸­çš„æ•æ„Ÿæ•°æ®ï¼Œæ­¤å¤–å®¹å™¨ä¹Ÿå¯ä»¥æŒ‰ç¯å¢ƒå˜é‡çš„å½¢å¼ä½¿ç”¨è¿™äº›æ•°æ®ã€‚")]),e._v(" "),t("p",[e._v("ä½¿ç”¨é…ç½®æ–‡ä»¶åˆ›å»º mysecret.yamlï¼š")]),e._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\nkind Secret\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("mysecret\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("data")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  username"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("admin\n  password"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("123")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br")])]),t("p",[e._v("ä¿å­˜é…ç½®æ–‡ä»¶åï¼Œç„¶åæ‰§è¡Œ"),t("code",[e._v("kubectl apply -f mysecret.yaml")]),e._v("è¿›è¡Œåˆ›å»ºã€‚")]),e._v(" "),t("p",[e._v("åœ¨ pod ä¸­ä½¿ç”¨åˆ›å»ºå¥½çš„ secretï¼š")]),e._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# mypod.yaml")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Pod\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mypod\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mypod\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" yhlben/notepad\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("volumeMounts")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" foo\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("mountPath")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'etc/foo'")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("readOnly")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token boolean important"}},[e._v("true")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" foo\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("secret")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("secretName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mysecret\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br")])]),t("p",[e._v("æ‰§è¡Œ"),t("code",[e._v("kubectl apply -f mypod.yaml")]),e._v(" åˆ›å»º podï¼Œå¹¶ä½¿ç”¨ secretã€‚åˆ›å»ºå®Œæˆåï¼Œsecret ä¿å­˜åœ¨å®¹å™¨å†… /etc/foo/username ï¼Œ/etc/foo/password ç›®å½•ä¸‹ã€‚")]),e._v(" "),t("h3",{attrs:{id:"é›†ç¾¤ç›‘æ§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#é›†ç¾¤ç›‘æ§","aria-hidden":"true"}},[e._v("#")]),e._v(" é›†ç¾¤ç›‘æ§")]),e._v(" "),t("p",[e._v("åˆ›å»º k8s é›†ç¾¤å¹¶éƒ¨ç½²å®¹å™¨åŒ–åº”ç”¨åªæ˜¯ç¬¬ä¸€æ­¥ã€‚ä¸€æ—¦é›†ç¾¤è¿è¡Œèµ·æ¥ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿é›†ç¾¤ä¸€åˆ‡éƒ½æ˜¯æ­£å¸¸çš„ï¼Œè¿™å°±éœ€è¦å¯¹é›†ç¾¤è¿›è¡Œç›‘æ§ã€‚")]),e._v(" "),t("p",[e._v("å¸¸ç”¨çš„å¯è§†åŒ–ç›‘æ§å·¥å…·å¦‚ä¸‹ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("Weave Scope")]),e._v(" "),t("li",[e._v("Heapster")]),e._v(" "),t("li",[e._v("Prometheus Operator")])]),e._v(" "),t("p",[e._v("å…·ä½“çš„ä½¿ç”¨æ­¥éª¤å°±ç›´æ¥çœ‹æ–‡æ¡£äº†ï¼Œè¿™é‡Œä¸è¯¦ç»†è¯´æ˜ã€‚")]),e._v(" "),t("p",[e._v("é€šè¿‡é›†ç¾¤ç›‘æ§æˆ‘ä»¬èƒ½å¤ŸåŠæ—¶å‘ç°é›†ç¾¤å‡ºç°çš„é—®é¢˜ï¼Œä½†ä¸ºäº†æ–¹ä¾¿è¿›ä¸€æ­¥æ’æŸ¥é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œè¿›è¡Œæ—¥å¿—è®°å½•ã€‚")]),e._v(" "),t("p",[e._v("å¸¸ç”¨çš„æ—¥å¿—ç®¡ç†å·¥å…·å¦‚ä¸‹ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("Elasticsearch è´Ÿè´£å­˜å‚¨æ—¥å¿—å¹¶æä¾›æŸ¥è¯¢æ¥å£ã€‚")]),e._v(" "),t("li",[e._v("Fluentd è´Ÿè´£ä» k8s æœé›†æ—¥å¿—å¹¶å‘é€ç»™ Elasticsearchã€‚")]),e._v(" "),t("li",[e._v("Kibana æä¾›ä¸€ä¸ªå¯è§†åŒ–é¡µé¢ï¼Œç”¨æˆ·å¯ä»¥æµè§ˆå’Œæœç´¢æ—¥å¿—ã€‚")])]),e._v(" "),t("h2",{attrs:{id:"kubernetes-å®æˆ˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kubernetes-å®æˆ˜","aria-hidden":"true"}},[e._v("#")]),e._v(" Kubernetes å®æˆ˜")]),e._v(" "),t("p",[e._v("æˆ‘ä»¬æ¥å®æˆ˜éƒ¨ç½²ä¸€ä¸ª k8s è®°äº‹æœ¬é¡¹ç›®ï¼Œé¡¹ç›®ä½¿ç”¨ "),t("a",{attrs:{href:"https://cloud.docker.com/u/yhlben/repository/docker/yhlben/notepad",target:"_blank",rel:"noopener noreferrer"}},[e._v("yhlben/notepad"),t("OutboundLink")],1),e._v(" é•œåƒè¿›è¡Œæ„å»ºï¼Œè¯¥é•œåƒåœ¨éƒ¨ç½²åä¼šåœ¨ 8083 ç«¯å£ä¸Šæä¾›ä¸€ä¸ª web æœåŠ¡ï¼Œè®¿é—®è¯¥æœåŠ¡ï¼Œå³å¯æ‰“å¼€ä¸€ä¸ª"),t("a",{attrs:{href:"http://yinhengli.com:8083/",target:"_blank",rel:"noopener noreferrer"}},[e._v("è®°äº‹æœ¬ç½‘ç«™"),t("OutboundLink")],1),e._v("ã€‚")]),e._v(" "),t("p",[e._v("ä¸ºäº†é¿å…å®‰è£… k8s å‡ºç°çš„å„ç§å‘ï¼Œè¿™é‡Œä½¿ç”¨ "),t("a",{attrs:{href:"https://labs.play-with-k8s.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Play with Kubernetes"),t("OutboundLink")],1),e._v("è¿›è¡Œæ¼”ç¤ºã€‚")]),e._v(" "),t("p",[e._v("é¦–å…ˆåœ¨ Play with Kubernetes ä¸Šåˆ›å»º 2 å°æœåŠ¡å™¨ï¼Œnode1 ä½œä¸º master èŠ‚ç‚¹ï¼Œnode2 ä½œä¸ºå·¥ä½œèŠ‚ç‚¹ã€‚æ¥ä¸‹æ¥è¿›è¡Œä»¥ä¸‹æ“ä½œï¼›")]),e._v(" "),t("ul",[t("li",[e._v("åˆ›å»ºä¸€ä¸ªé›†ç¾¤ cluster")]),e._v(" "),t("li",[e._v("åŠ å…¥ node èŠ‚ç‚¹")]),e._v(" "),t("li",[e._v("åˆå§‹åŒ– cluster ç½‘ç»œ")]),e._v(" "),t("li",[e._v("åˆ›å»º controller")]),e._v(" "),t("li",[e._v("åˆ›å»º service")]),e._v(" "),t("li",[e._v("æ‰§è¡Œéƒ¨ç½²")])]),e._v(" "),t("h3",{attrs:{id:"åˆ›å»ºä¸€ä¸ªé›†ç¾¤-cluster"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºä¸€ä¸ªé›†ç¾¤-cluster","aria-hidden":"true"}},[e._v("#")]),e._v(" åˆ›å»ºä¸€ä¸ªé›†ç¾¤ cluster")]),e._v(" "),t("p",[e._v("ä½¿ç”¨ kubeadm init å³å¯åˆ›å»ºä¸€ä¸ªé›†ç¾¤ã€‚")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubeadm init --apiserver-advertise-address "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("hostname")]),e._v(" -i"),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("æ‰§è¡Œå®Œæˆåä¼šç”Ÿæˆ tokenï¼Œè¿™æ ·å…¶ä»–èŠ‚ç‚¹å°±å¯ä»¥å‡­å€Ÿè¿™ä¸ª token åŠ å…¥è¯¥é›†ç¾¤ã€‚")]),e._v(" "),t("p",[t("img",{attrs:{src:"devops-kubernetes-step1.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤1"}})]),e._v(" "),t("h3",{attrs:{id:"åŠ å…¥-node-èŠ‚ç‚¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åŠ å…¥-node-èŠ‚ç‚¹","aria-hidden":"true"}},[e._v("#")]),e._v(" åŠ å…¥ node èŠ‚ç‚¹")]),e._v(" "),t("p",[e._v("åœ¨ node2 æœºå™¨ä¸Šï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubeadm "),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("join")]),e._v(" 192.168.0.8:6443 --token nfs9d0.z7ibv3xokif1mnmv \\\n    --discovery-token-ca-cert-hash sha256:6587f474ae1543b38954b0e560832ff5b7c67f79e1d464e7f59e33b0fefd6548\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("å‘½ä»¤æ‰§è¡Œå®Œæ¯•åï¼Œå³å¯çœ‹åˆ° node2 å·²ç»åŠ å…¥æˆåŠŸã€‚")]),e._v(" "),t("p",[t("img",{attrs:{src:"devops-kubernetes-step2.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤2"}})]),e._v(" "),t("h3",{attrs:{id:"æŸ¥çœ‹é›†ç¾¤çŠ¶æ€"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æŸ¥çœ‹é›†ç¾¤çŠ¶æ€","aria-hidden":"true"}},[e._v("#")]),e._v(" æŸ¥çœ‹é›†ç¾¤çŠ¶æ€")]),e._v(" "),t("p",[e._v("åœ¨ master èŠ‚ç‚¹ä¸Šï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl get node\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"devops-kubernetes-step3.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤3"}})]),e._v(" "),t("p",[e._v("å¯ä»¥çœ‹åˆ°ï¼Œé›†ç¾¤ä¸­å­˜åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œnode1 å’Œ node2ï¼Œä½†è¿™ä¸¤ä¸ªèŠ‚ç‚¹çš„éƒ½æ˜¯ NotReady çŠ¶æ€ï¼Œä¸ºä»€ä¹ˆï¼Ÿ")]),e._v(" "),t("p",[e._v("ç­”ï¼šå› ä¸ºæ²¡æœ‰åˆ›å»ºé›†ç¾¤ç½‘ç»œã€‚")]),e._v(" "),t("h3",{attrs:{id:"åˆ›å»ºé›†ç¾¤ç½‘ç»œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»ºé›†ç¾¤ç½‘ç»œ","aria-hidden":"true"}},[e._v("#")]),e._v(" åˆ›å»ºé›†ç¾¤ç½‘ç»œ")]),e._v(" "),t("p",[e._v("æ‰§è¡Œä»¥ä¸‹ä»£ç åˆ›å»ºé›†ç¾¤ç½‘ç»œã€‚")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl apply -n kube-system -f \\\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"https://cloud.weave.works/k8s/net?k8s-version='),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("kubectl version "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" base64 "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("tr")]),e._v(" -d "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'\\n'")]),t("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v('"')]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("æ‰§è¡Œå‘½ä»¤åï¼Œç¨ç­‰ä¸€ä¸‹ï¼Œç„¶åæŸ¥çœ‹ node çŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œé›†ç¾¤ä¸­çš„ä¸¤ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ Ready çŠ¶æ€äº†ã€‚")]),e._v(" "),t("p",[t("img",{attrs:{src:"devops-kubernetes-step4.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤4"}})]),e._v(" "),t("h3",{attrs:{id:"åˆ›å»º-deployment"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-deployment","aria-hidden":"true"}},[e._v("#")]),e._v(" åˆ›å»º Deployment")]),e._v(" "),t("p",[e._v("æˆ‘ä»¬é€šè¿‡é…ç½®æ–‡ä»¶æ¥åˆ›å»º deploymentï¼Œæ–°å»º deployment.yaml æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),e._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# é…ç½®æ–‡ä»¶æ ¼å¼çš„ç‰ˆæœ¬")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" apps/v1\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åˆ›å»ºçš„èµ„æºç±»å‹")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Deployment\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# èµ„æºçš„å…ƒæ•°æ®")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" notepad\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åˆ›å»º label æ–¹ä¾¿ service åŒ¹é…")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mytest\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# è§„æ ¼è¯´æ˜")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å®šä¹‰ pod æ•°é‡")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("replicas")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# é€šè¿‡ label æ–¹ä¾¿ deployment æ‰¾åˆ°å¯¹åº”çš„ pod")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("matchLabels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mytest\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# å®šä¹‰ pod çš„æ¨¡æ¿")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("template")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# pod çš„å…ƒæ•°æ®")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mytest\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# æè¿° pod çš„è§„æ ¼")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" notepad\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" yhlben/notepad\n          "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("containerPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("8083")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br"),t("span",{staticClass:"line-number"},[e._v("15")]),t("br"),t("span",{staticClass:"line-number"},[e._v("16")]),t("br"),t("span",{staticClass:"line-number"},[e._v("17")]),t("br"),t("span",{staticClass:"line-number"},[e._v("18")]),t("br"),t("span",{staticClass:"line-number"},[e._v("19")]),t("br"),t("span",{staticClass:"line-number"},[e._v("20")]),t("br"),t("span",{staticClass:"line-number"},[e._v("21")]),t("br"),t("span",{staticClass:"line-number"},[e._v("22")]),t("br"),t("span",{staticClass:"line-number"},[e._v("23")]),t("br"),t("span",{staticClass:"line-number"},[e._v("24")]),t("br"),t("span",{staticClass:"line-number"},[e._v("25")]),t("br"),t("span",{staticClass:"line-number"},[e._v("26")]),t("br"),t("span",{staticClass:"line-number"},[e._v("27")]),t("br"),t("span",{staticClass:"line-number"},[e._v("28")]),t("br"),t("span",{staticClass:"line-number"},[e._v("29")]),t("br"),t("span",{staticClass:"line-number"},[e._v("30")]),t("br"),t("span",{staticClass:"line-number"},[e._v("31")]),t("br")])]),t("p",[e._v("æ–‡ä»¶åˆ›å»ºä¹‹åï¼Œæ‰§è¡Œå‘½ä»¤ï¼š")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl apply -f ./deployment.yaml\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h3",{attrs:{id:"åˆ›å»º-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#åˆ›å»º-service","aria-hidden":"true"}},[e._v("#")]),e._v(" åˆ›å»º Service")]),e._v(" "),t("p",[e._v("åˆ›å»º service å’Œ deployment ç±»ä¼¼ï¼Œæ–°å»º service.yaml æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š")]),e._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("service\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mytest\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åœ¨èŠ‚ç‚¹ä¸Šæš´éœ²ç«¯å£ï¼Œè®¿é—®æœåŠ¡ï¼Œç«¯å£éšæœº")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" NodePort\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("8083")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# åŒ¹é… pod")]),e._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" mytest\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br")])]),t("p",[e._v("æ–‡ä»¶åˆ›å»ºä¹‹åï¼Œæ‰§è¡Œå‘½ä»¤ï¼š")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl apply -f ./service.yaml\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("h3",{attrs:{id:"æŸ¥çœ‹åˆ›å»ºç»“æœ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æŸ¥çœ‹åˆ›å»ºç»“æœ","aria-hidden":"true"}},[e._v("#")]),e._v(" æŸ¥çœ‹åˆ›å»ºç»“æœ")]),e._v(" "),t("p",[e._v("ä½¿ç”¨ kubectl get deployment å’Œ kubectl get service æŸ¥çœ‹åˆ›å»ºç»“æœã€‚")]),e._v(" "),t("p",[t("img",{attrs:{src:"devops-kubernetes-step5.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤5"}})]),e._v(" "),t("p",[e._v("å¯ä»¥çœ‹åˆ°ï¼Œdeployment å’Œ service å‡åˆ›å»ºæˆåŠŸï¼Œå¹¶ä¸”å·²çŸ¥ service æš´éœ²çš„ ip åœ°å€ä¸ºï¼š10.107.22.212ï¼Œç«¯å£å·ä¸º 8083ã€‚")]),e._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",[e._v("æˆ‘ä»¬æ²¡æœ‰æŒ‡å®š service çš„ NodePortï¼Œç³»ç»Ÿå°±è‡ªåŠ¨åˆ†é…äº†ä¸€ä¸ª 32494 ç«¯å£ã€‚è¿™æ ·å°±èƒ½é€šè¿‡ "),t("code",[e._v("master èŠ‚ç‚¹çš„ ip:32494")]),e._v(" æ¥è¿›è¡Œè®¿é—®äº†ã€‚")])]),e._v(" "),t("h3",{attrs:{id:"è®¿é—®éƒ¨ç½²ç»“æœ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è®¿é—®éƒ¨ç½²ç»“æœ","aria-hidden":"true"}},[e._v("#")]),e._v(" è®¿é—®éƒ¨ç½²ç»“æœ")]),e._v(" "),t("p",[e._v("åœ¨ node1 æˆ–è€… node2 ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ service æš´éœ²çš„ ip æ¥è®¿é—®ç½‘ç«™ã€‚")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("curl")]),e._v(" 10.107.22.212:8083\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"devops-kubernetes-step6.png",alt:"Kubernetes å®æˆ˜æ­¥éª¤6"}})]),e._v(" "),t("p",[e._v("åˆ°è¿™é‡Œï¼Œå·²ç»ç®—éƒ¨ç½²æˆåŠŸäº†ï¼Œå¤§å®¶è‚¯å®šæœ‰ç–‘é—®ï¼Œéƒ¨ç½²ä¸€ä¸ªå¦‚æ­¤ç®€å•çš„ web åº”ç”¨å°±è¿™ä¹ˆéº»çƒ¦ï¼Œåˆ°åº• k8s å¥½åœ¨å“ªé‡Œï¼Ÿ")]),e._v(" "),t("h3",{attrs:{id:"k8s-è¿ç»´"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#k8s-è¿ç»´","aria-hidden":"true"}},[e._v("#")]),e._v(" K8s è¿ç»´")]),e._v(" "),t("p",[e._v("é¡¹ç›®å·²ç»éƒ¨ç½²ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®æˆ˜ä¸€ä¸ªè¿ç»´ã€‚")]),e._v(" "),t("h4",{attrs:{id:"æ¡ˆä¾‹-1"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ¡ˆä¾‹-1","aria-hidden":"true"}},[e._v("#")]),e._v(" æ¡ˆä¾‹ 1")]),e._v(" "),t("p",[e._v("å…¬å¸è¦åšåŒ 11 æ´»åŠ¨ï¼Œéœ€è¦è‡³å°‘ 100 ä¸ªå®¹å™¨æ‰èƒ½æ»¡è¶³ç”¨æˆ·è¦æ±‚ï¼Œåº”è¯¥æ€ä¹ˆåšï¼Ÿ")]),e._v(" "),t("p",[e._v("é¦–å…ˆï¼Œåº”è¯¥å°½å¯èƒ½åˆ©ç”¨å½“å‰æ‹¥æœ‰çš„æœåŠ¡å™¨èµ„æºï¼Œåˆ›å»ºæ›´å¤šçš„å®¹å™¨æ¥å‚ä¸è´Ÿè½½å‡è¡¡ï¼Œé€šè¿‡ docker stats å¯ä»¥æŸ¥çœ‹å®¹å™¨å ç”¨çš„ç³»ç»Ÿèµ„æºæƒ…å†µã€‚å¦‚æœå……åˆ†åˆ©ç”¨åä»ç„¶ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œå°±æ ¹æ®å‰©ä½™éœ€è¦çš„å®¹å™¨ï¼Œè®¡ç®—å‡ºéœ€è¦è´­ä¹°å¤šå°‘æœºå™¨ï¼Œå®ç°èµ„æºçš„åˆç†åˆ©ç”¨ã€‚")]),e._v(" "),t("ul",[t("li",[e._v("è´­ä¹°æœåŠ¡å™¨ï¼Œå°†æœåŠ¡å™¨ä½œä¸º node èŠ‚ç‚¹ï¼Œjoin åˆ°é›†ç¾¤ä¸­ã€‚")]),e._v(" "),t("li",[e._v("æ‰§è¡Œæ‰©å®¹å‘½ä»¤ã€‚")])]),e._v(" "),t("p",[e._v("æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°±èƒ½å°†å®¹å™¨æ‰©å±•åˆ° 100 ä¸ªã€‚")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl scale deployments/notepad --replicas"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("100\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹ deployment.yaml ä¸­çš„ replicas å­—æ®µï¼Œæ‰§è¡Œ "),t("code",[e._v("kubectl apply -f deployment.yaml")]),e._v("å»æ‰§è¡Œæ‰©å±•ã€‚å¦‚æœæ´»åŠ¨ç»“æŸäº†ï¼Œåªéœ€è¦å°†å¤šä½™çš„æœåŠ¡å™¨åˆ é™¤ï¼Œç¼©å‡å®¹å™¨æ•°é‡å³å¯è¿˜åŸåˆ°ä¹‹å‰çš„æ•ˆæœã€‚")]),e._v(" "),t("h4",{attrs:{id:"æ¡ˆä¾‹-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ¡ˆä¾‹-2","aria-hidden":"true"}},[e._v("#")]),e._v(" æ¡ˆä¾‹ 2")]),e._v(" "),t("p",[e._v("åŒ 11 æ´»åŠ¨å¾ˆç«çˆ†ï¼Œä½†å‡ºç°äº†ä¸€ä¸ª bugï¼Œéœ€è¦ç´§æ€¥ä¿®å¤ï¼Œå¦‚æœå®ç°æ»šåŠ¨æ›´æ–°ï¼Ÿ")]),e._v(" "),t("p",[e._v("æ»šåŠ¨æ›´æ–°å°±æ˜¯åœ¨ä¸å®•æœºçš„æƒ…å†µä¸‹ï¼Œå®ç°ä»£ç æ›´æ–°ã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä¿®æ”¹ image å³å¯ã€‚")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("set")]),e._v(" image deployments/notepad notepad"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("yhlben/notepad:v1\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("æˆ–è€…ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹ deployment.yaml ä¸­çš„ image å­—æ®µï¼Œæ‰§è¡Œ "),t("code",[e._v("kubectl apply -f deployment.yaml")]),e._v("å»æ‰§è¡Œå‡çº§ã€‚")]),e._v(" "),t("p",[e._v("å¦‚æœæ›´æ–°å‡ºäº†é—®é¢˜ï¼Œk8s å†…ç½®äº†ä¸€é”®è¿˜åŸä¸Šä¸ªç‰ˆæœ¬çš„å‘½ä»¤ï¼š")]),e._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[e._v("kubectl rollout undo deployments/notepad\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("é€šè¿‡è¿™ä¸¤ä¸ªæ¡ˆä¾‹ï¼Œæ„Ÿè§‰åˆ° k8s éå¸¸é€‚åˆç®¡ç†é¡¹ç›®çš„éƒ¨ç½²ä¸è¿ç»´ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒçº¿ä¸Šä»£ç æŒ‚æ‰äº†ã€‚")]),e._v(" "),t("h2",{attrs:{id:"æ€»ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“","aria-hidden":"true"}},[e._v("#")]),e._v(" æ€»ç»“")]),e._v(" "),t("p",[e._v("æœ¬æ–‡çš„ç›®çš„å°±æ˜¯å…¥é—¨ k8sï¼Œé€šè¿‡ä¸€ä¸ªç®€å•çš„é›†ç¾¤æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œä½†å…¶ä¸­ä¹Ÿè¸©äº†å¥½å¤šå‘ï¼Œå…·ä½“å¦‚ä¸‹ï¼š")]),e._v(" "),t("ul",[t("li",[e._v("ä½¿ç”¨ minikube æ­å»ºé¡¹ç›®\n"),t("ul",[t("li",[e._v("æœ¬æƒ³åœ¨æœ¬åœ°ä½¿ç”¨ minikube æ­å»ºä¸€å¥— k8s é›†ç¾¤ï¼Œæ²¡æƒ³åˆ°å¾ˆå¤šåŒ…è£…ä¸ä¸Šï¼Œå…¨å±€ä»£ç†ä¹Ÿä¸è¡Œã€‚")])])]),e._v(" "),t("li",[e._v("ä½¿ç”¨ google clould ä¸Šçš„æœåŠ¡å™¨\n"),t("ul",[t("li",[e._v("ç”±äºæ˜¯æ–°æœåŠ¡å™¨ï¼Œéœ€è¦å„ç§å®‰è£…ç¯å¢ƒï¼Œdockerï¼Œkubeadmï¼Œkubectl ç­‰ï¼Œå®‰è£…è¿‡ç¨‹å¯èƒ½ä¼šé‡åˆ°æŠ¥é”™ã€‚")]),e._v(" "),t("li",[e._v("ä¸çŸ¥é“å“ªå¤©æ‰‹æ»‘äº†ä¸€ä¸‹ï¼Œè¯•ç”¨è´¦å·å˜æˆäº†ä»˜è´¹è´¦å·ï¼Œèµ é‡‘ $300 å°±è¿™æ ·æ²¡äº† ğŸ˜­ã€‚")]),e._v(" "),t("li",[e._v("ä¸è¿‡åœ¨ gogole clould ä¸Šï¼Œè§£å†³äº†ç½‘ç»œé—®é¢˜ï¼Œä¾èµ–åŒ…éƒ½èƒ½è£…ä¸Šã€‚")])])]),e._v(" "),t("li",[e._v("ä½¿ç”¨ play with kubernetes\n"),t("ul",[t("li",[e._v("ä¸Šå‘¨ä½¿ç”¨ play with kubernetes åˆšæ–°å»ºå®Œä¸€ä¸ªå®ä¾‹ï¼Œå°±è¢«è¸¢ä¸‹çº¿ï¼Œç®€ç›´æ¶å¿ƒï¼Œä¸è¿‡æœ€è¿‘å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚")]),e._v(" "),t("li",[e._v("æ— æ³•éªŒè¯å…¬ç½‘è®¿é—®æƒ…å†µã€‚")])])])]),e._v(" "),t("p",[e._v("æœ€åï¼Œæ¨èä¸€ä¸‹ã€Šæ¯å¤© 5 åˆ†é’Ÿç©è½¬ Kubernetesã€‹è¿™æœ¬ä¹¦ï¼Œä¸€æœ¬éå¸¸é€‚åˆæ–°æ‰‹å…¥é—¨ k8s çš„å®æˆ˜ä¹¦ã€‚ä¹¦ä¸­é€šè¿‡å¤§é‡çš„ç®€å•å®æˆ˜ï¼Œä»æ˜“åˆ°éš¾ï¼Œè®©æˆ‘çœŸæ­£ç†è§£äº† k8sï¼Œæœ¬æ–‡ä¸­çš„å¤§é‡ç†è®ºçŸ¥è¯†ä¹Ÿéƒ½æ¥è‡ªè¿™æœ¬ä¹¦ã€‚")])])},[],!1,null,null,null);s.default=n.exports}}]);